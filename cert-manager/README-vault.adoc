= Jetstack Cert-Manager on Openshift 4.7

== Introduction

Instatlling and Configuring Cert-Manager with a CA key pair on OpenShift 4.7

== Prerequisites

* CA cert and private key pair for Cert-Manager Issuing

== Installation

=== Create Project for Cert-Manager
[source,bash]
-----
oc new-project cert-manager
-----

=== Install Cert-Manager

==== via Manifests
[source,bash]
-----
oc apply -f https://github.com/jetstack/cert-manager/releases/download/v1.2.0/cert-manager.yaml
-----

// ==== via Operator
// [source,bash]
// -----
// -----

=== Create ClusterIssuer

// ==== Vault ClusterIssuer
// [source,yaml]
// -----
// apiVersion: cert-manager.io/v1alpha2
// kind: ClusterIssuer
// metadata:
//   name: letsencrypt-prod
// spec:
//   vault:
//     server: https://vault.vault.svc:2245/
//     path: /cert-manager/ca
//     caBundle: # Base64 of Vault server certificate
//     auth:
//       kubernetes:
//         mountPath: /v1/auth/foo/login
//         role: cert-manager-sa
//         secretRef: service-account-jwt
//       tokenSecretRef:
//         key: keyname
//         name: 
// -----

==== CA ClusterIssuer
[source,yaml]
-----
apiVersion: v1
kind: Secret
metadata:
  name: ca-key-pair
  namespace: sandbox
data:
  tls.crt: ZZZZZZZ
  tls.key: ZZZZZZZ
-----

[source,yaml]
-----
apiVersion: cert-manager.io/v1alpha2
kind: ClusterIssuer
metadata:
  name: letsencrypt-prod
spec:
  ca:
    secretName: ca-key-pair
-----

=== Create Certificate
[source,yaml]
-----
apiVersion: cert-manager.io/v1alpha2
kind: Certificate
metadata:
  name: my-certificate
  namespace: my-namespace
spec:
  secretName: my-certificate-secret
  issuerRef:
    name: letsencrypt-prod
    kind: ClusterIssuer
-----
